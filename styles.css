:root {
  --bg: #0b0c10;
  --fg: #e6e6e6;
  --muted: #9aa0a6;
  --card: #11131a;
  --border: #23252e;
  --accent: #7aa2f7;
  --radius: 12px;
  --shadow: 0 8px 24px rgba(0, 0, 0, .25);
}

* {
  box-sizing: border-box
}

html,
body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--fg);
  font: 16px/1.6 system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC", "Hiragino Sans", "Microsoft JhengHei", sans-serif
}

a {
  color: inherit;
  text-decoration: none
}

.container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 0 20px
}

/* Header */
.site-header {
  padding: 40px 0 20px
}

.site-header h1 {
  margin: 0 0 8px;
  font-size: 32px;
  letter-spacing: .4px
}

.subtitle {
  margin: 0 0 8px;
  color: var(--muted)
}

.meta a {
  margin-right: 12px;
  color: var(--accent)
}

/* 列を制御する */
.controls {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 12px;
  margin: 12px auto 20px;
  align-items: center
}

.filters {
  display: flex;
  flex-wrap: wrap;
  gap: 8px
}

.btn {
  padding: 10px 14px;
  border: 1px solid var(--border);
  background: #0d0f16;
  border-radius: 999px;
  cursor: pointer;
  touch-action: manipulation
}

.btn:hover {
  border-color: var(--accent)
}

.btn.is-checked {
  background: var(--accent);
  color: #0c1022;
  border-color: transparent
}

.search-sort {
  display: flex;
  gap: 8px;
  align-items: center
}

#search,
#sort {
  padding: 10px 12px;
  border: 1px solid var(--border);
  background: #0d0f16;
  color: var(--fg);
  border-radius: 10px;
  min-height: 40px
}

/* === ドロップダウン（select）統一スタイル === */
select,
#sort {
  appearance: none;             /* デフォルトスタイルを隠す（各ブラウザ） */
  -webkit-appearance: none;
  -moz-appearance: none;

  padding: 10px 36px 10px 14px; /* 右側は矢印用に空ける */
  border: 1px solid var(--border);
  border-radius: 10px;
  background-color: #0d0f16;
  color: var(--fg);
  font-size: 15px;
  line-height: 1.4;
  cursor: pointer;
  transition: all .2s ease;
  box-shadow: 0 2px 6px rgba(0,0,0,.25);
  position: relative;
}

/* hover / focus 状態 */
select:hover,
#sort:hover {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(122,162,247,.25);
}
select:focus,
#sort:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(122,162,247,.35);
}

/* プルダウン矢印は pseudo-element を用いて自前で描画する */
select::after,
#sort::after {
  content: "";
  position: absolute;
  pointer-events: none;
  top: 50%;
  right: 12px;
  width: 0;
  height: 0;
  transform: translateY(-50%);
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 6px solid var(--muted);
}

/* プルダウンを開いた時 */
select:focus::after,
#sort:focus::after {
  border-top-color: var(--accent);
}

/* プルダウン本体 */
select option,
#sort option {
  background: #0b0c10;
  color: var(--fg);
  border: none;
}



/* Isotope：.grid-sizer と百分率カラム幅で RWD（レスポンシブ）に対応 */
/* === 計算式（Masonry）：カラム幅と倍率 === */
.grid {
  position: relative;
  transition: height .25s ease;
  /* デフォルト（デスクトップ）: 4 カラム、16px 間隔 */
  --cols: 4;
  --gut: 16px;
  --colw: calc((100% - (var(--cols) - 1) * var(--gut)) / var(--cols));
  padding: 4px 0;
}

/* sizer は Isotope によって読み取られる：列幅と間隔 */
.grid-sizer,
.grid-item {
  width: var(--colw);
}

.gutter-sizer {
  width: var(--gut);
}

/* 上下間隔用倍数（= 水平間隔），Isotope は高さに計上 */
.grid-item {
  margin-bottom: var(--gut);
  will-change: transform, opacity;
}

/* —— 幅倍数：間隔を含む —— */
/* w2 = 2 カラム + 1 個の間隔；w3 = 3 カラム + 2 個の間隔 */
.grid-item--w2 {
  width: calc(2 * var(--colw) + 1 * var(--gut));
}

.grid-item--w3 {
  width: calc(3 * var(--colw) + 2 * var(--gut));
}

/* —— 高さ倍数：比率で実現（基準 16:10） —— */
.thumb {
  aspect-ratio: 16 / 10;
}

/* 高さ×2 */
.grid-item--h2 .thumb {
  aspect-ratio: 16 / 20;
}

/* 高さ×3 */
.grid-item--h3 .thumb {
  aspect-ratio: 16 / 30;
}

/* タイプごとのデフォルト比率（視覚的な差異を強調するために残しておいてもよい） */
.grid-item[data-type="Project"] .thumb {
  aspect-ratio: 4 / 3;
}

.grid-item[data-type="Blog"] .thumb {
  aspect-ratio: 16 / 9;
}

/* —— ブレークポイント：カラム数とガターを倍数で変化させ、小画面での過度な横幅を防ぐ —— */
/* Pad：3 カラム、12px */
@media (min-width: 720px) and (max-width: 1023.98px) {
  .grid {
    --cols: 3;
    --gut: 12px;
    --colw: calc((100% - (var(--cols) - 1) * var(--gut)) / var(--cols));
  }

  /* .grid {
    --cols: 2;
    --gut: 14px;
    --colw: calc((100% - (var(--cols) - 1) * var(--gut)) / var(--cols));
  } */

  /* 2 カラム時、w3 ははみ出すため、強制的に収束 */
  .grid-item--w3 {
    width: 100% !important;
  }
  

}

/* スマホ：2 カラム、12px（或いはより安定させたい場合は 1 カラムに変更、下の media を参照） */
@media (max-width: 719.98px) {
  .grid {
    --cols: 2;
    --gut: 12px;
    --colw: calc((100% - (var(--cols) - 1) * var(--gut)) / var(--cols));
  }

  /* cols = 2 の場合、w2 の計算式はちょうど 100％（2×colw + 1×gut = 100％）となるため問題なし。
　   w3 は存在しないため強制的に収束させる。 */
  .grid-item--w3 {
    width: 100% !important;
  }

  .site-header {
    padding: 28px 0 16px
  }

  .site-header h1 {
    font-size: 26px
  }

  .controls {
    grid-template-columns: 1fr;
    gap: 10px
  }

  .filters {
    gap: 6px
  }

  .btn {
    padding: 9px 12px;
    min-height: 40px
  }

  .search-sort {
    gap: 6px
  }

  #search {
    flex: 1
  }

  .post-hero .container {
    padding: 0 14px
  }

  .post-content {
    padding: 16px
  }


  /* スマホ最適化：タッチ領域を拡大 */
  select,
  #sort {
    width: 100%;
    font-size: 16px;
    padding: 10px 38px 10px 14px;
  }
}

/* 最小画面で完全に安全にしたい場合：1カラム、12pxに変更（どちらかを選択） */
@media (max-width: 479.98px) {
  .grid {
    --cols: 1;
    --gut: 12px;
    --colw: calc((100% - (var(--cols) - 1) * var(--gut)) / var(--cols));
  }

  .grid-item--w2,
  .grid-item--w3 {
    width: 100% !important;
  }
}

/* その他のスタイルは変更なし（card/thumb/hero…） */

/* カード */
.card {
  display: block;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: var(--shadow);
  transition: transform .2s ease, border-color .2s ease
}

.card:hover {
  transform: translateY(-2px);
  border-color: var(--accent)
}

.card-body {
  padding: 14px 14px 12px
}

.card-body h3 {
  margin: 0 0 6px;
  font-size: 18px;
  letter-spacing: .2px
}

.desc {
  margin: 0 0 10px;
  color: var(--muted);

  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;     /* 2 行で切る */
  overflow: hidden;
  position: relative;
  padding-right: 70px;
}

.desc:empty::before {
  content: "[...]";
  color: var(--muted);
}

.desc.more::after {
  content: "[more]";
  position: absolute;
  bottom: 0;
  right: 0;
  padding-left: 6px;
  background: var(--bg);
  color: var(--accent);
}

/* feature test */
/* 滑鼠 hover 時：完整展開 */
.card:hover .desc {
  -webkit-line-clamp: unset;  /* 移除截斷 */
  max-height: none;
  overflow: visible;
}

/* hover 展開時 more 消失 */
.card:hover .desc.more::after {
  opacity: 0;
}
/**/


.meta-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  color: var(--muted);
  font-size: 13px
}


/* 画像コンテナ：純 CSS 骨架（プレースホルダー画像を使用しない） */
.thumb,
.hero {
  position: relative;
  overflow: hidden;
  border-radius: 12px;
  box-shadow: var(--shadow);
  aspect-ratio: 16/9;
  /* hero が比率を上書き */
  background: linear-gradient(90deg, #14161d 25%, #1b1f2a 50%, #14161d 75%);
  background-size: 200% 100%;
  animation: skeleton 1.1s linear infinite;
}

.hero {
  aspect-ratio: 21/9
}

/* 見出し画像をよりワイドなビジュアルにする */
@keyframes skeleton {
  0% {
    background-position: 200% 0
  }

  100% {
    background-position: -200% 0
  }
}

.thumb>img,
.hero>img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  opacity: 0;
  transition: opacity .25s ease;
  display: block;
}

.thumb>img.img-loaded,
.hero>img.img-loaded {
  opacity: 1 !important
}

/* 失敗時：JS は .is-error を付与するだけで、画像は一切使用しない */
.thumb.is-error::before,
.hero.is-error::before {
  content: "No Image";
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  color: #9aa0a6;
  font-size: 14px;
  letter-spacing: .08em;
  background: linear-gradient(180deg, #151823 0%, #11131a 100%);
  border: 1px dashed #2a2f3a;
  border-radius: 12px;
}

/* 文章 */
.post-hero {
  margin: 32px 0 24px
}

.post-hero .container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 0 20px
}

.post-layout {
  display: grid;
  gap: 24px;
  grid-template-columns: 1fr
}

@media (min-width:992px) {
  .post-layout {
    grid-template-columns: 220px 1fr
  }
}

.post-content {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px;
  box-shadow: var(--shadow)
}

.post-content img {
  max-width: 100%;
  height: auto;
  border-radius: 10px
}

/* TOC */
.toc {
  position: sticky;
  top: 16px;
  align-self: start;
  background: #0d0f16;
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 12px
}

.toc h3 {
  margin: 0 0 8px;
  font-size: 14px;
  color: var(--muted)
}

.toc ul {
  list-style: none;
  padding: 0;
  margin: 0
}

.toc li {
  margin: 6px 0;
  font-size: 14px
}

.toc .toc-h2 {
  margin-left: 8px
}

.toc .toc-h3 {
  margin-left: 16px
}

.toc a {
  color: var(--accent)
}

.back-link {
  color: var(--accent)
}

/* Lightbox */
.lightbox {
  position: fixed;
  inset: 0;
  display: none
}

.lightbox.show {
  display: block;
  z-index: 9999
}

.lightbox-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, .8)
}

.lightbox-img {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  max-width: 92vw;
  max-height: 92vh;
  border-radius: 12px
}

.lightbox-close {
  position: absolute;
  top: 16px;
  right: 20px;
  background: transparent;
  color: #fff;
  border: 1px solid rgba(255, 255, 255, .4);
  border-radius: 999px;
  font-size: 24px;
  width: 40px;
  height: 40px;
  cursor: pointer
}

/* Footer */
.site-footer {
  padding: 48px 0;
  color: var(--muted);
  text-align: center;
  border-top: 1px solid var(--border);
  margin-top: 40px
}



/* 画像読み込み完了後、スケルトン背景とアニメーションをオフにする */
.thumb.is-loaded {
  background: none;
  animation: none;
}

.post-hero .hero.is-loaded {
  background: none;
  animation: none;
}

/* ===== コントロール列：水平スクロールの例 ===== */
.filters-box{
  position:relative; overflow:hidden;  /* 外側はスクロールしない */
}

/* 単一行、幅を超えた部分は隠し、水平スクロールを許可 */
.filters{
  display: flex;
  flex-wrap: nowrap;       /* キーポイント：改行しない */
  gap: 8px;
  overflow-x: auto;        /* 水平スクロール可能 */
  overflow-y: hidden;
  scrollbar-width: none;   /* Firefox スクロールバーを非表示 */
  -ms-overflow-style: none;
  position: relative;
  padding-inline: 8px;     /* 端に少し余白を残す */
}
.filters::-webkit-scrollbar{ 
  display:none; 
} /* WebKit スクロールバーを非表示 */

/* 両側にフェードアウトしてスクロール可能であることを示す（ボタンのクリックを妨げない） */
.filters-box::before,
.filters-box::after{
  content:"";
  position:absolute;
  top:0; 
  bottom:0; 
  width:28px; 
  pointer-events:none;
  z-index:1;
}
.filters-box::before{
  left:0; background:linear-gradient(90deg, var(--bg) 0%, transparent 100%);
}
.filters-box::after{
  right:0; background:linear-gradient(270deg, var(--bg) 0%, transparent 100%);
}

/* ボタンは縮小せず、可読性を保つ */
.filters .btn{ 
  flex: 0 0 auto;
  color: var(--fg); 
}
